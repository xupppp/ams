<link rel="stylesheet" href="vendor/layui/css/layui.css">
<script type="text/javascript" src="vendor/layui/layui.js"></script>
<script type="text/javascript" src="vendor/jquery/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.params.js"></script>
<body style="background: transparent url(img/PTS_Movie_Branding_Background.jpg)no-repeat 0 0;background-attachment: fixed;background-size: cover;">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header" style="z-index:9999;position: relative;">

		<!-- 头部区域 -->
		<ul class="layui-nav" style="padding: 0 200px;">
			<div class="layui-logo" style="color:white;">AMS-stu</div>
			<li class="layui-nav-item">
				<a href="stu-index">首页</a>
			</li>
			<li class="layui-nav-item">
				<a href="#">社团</a>
				<dl class="layui-nav-child">
				    <dd>
						<a href="club-list">社团展示</a>
					</dd>
					<dd>
						<a href="club-build" id="nav-buildclub">创建社团</a>
					</dd>
				</dl>
			</li>
			<li class="layui-nav-item">
				<a href="#">活动</a>
				<dl class="layui-nav-child">
					<dd>
						<a href="activity-all-list">校内活动</a>
					</dd>
					<dd>
						<a href="activity-inner-list">社内活动</a>
					</dd>
				</dl>
			</li>
			<li class="layui-nav-item">
				<a href="news-all-list">新闻</a>
			</li>
			<li class="layui-nav-item">
				<a href="javascript:;">我的</a>
				<dl class="layui-nav-child">
					<dd>
						<a href="club-mine">我的社团</a>
					</dd>
					<dd>
						<a href="notice-mine">我的公告</a>
					</dd>
					<dd>
						<a href="myAct">我的活动</a>
					</dd>
				</dl>
			</li>
			<li class="layui-nav-item" id="nav-manager">
				<a href="javascript:;">管理</a>
				<dl class="layui-nav-child">
					<dd>
						<a href="manageClub">社团管理</a>
					</dd>
					<dd>
						<a href="manageNotice">公告管理</a>
					</dd>
					<dd>
						<a href="addNotice">发布公告</a>
					</dd>
					<dd>
						<a href="manageAct">活动管理</a>
					</dd>
					<dd>
						<a href="applyAct">申请活动</a>
					</dd>
		            <dd>
						<a href="managenews">新闻管理</a>
					</dd>
					<dd>
						<a href="addnews">发布新闻</a>
					</dd>
				</dl>
			 </li>
		</ul>

		<ul class="layui-nav layui-layout-right">
			<li class="layui-nav-item layui-hide-xs" lay-unselect>
				<input type="text" placeholder="搜索..." autocomplete="off" class="layui-input layui-input-search" layadmin-event="serach" lay-action="template/search/keywords=">
			</li>
			<li class="layui-nav-item">
				<a href="javascript:;" id='username'>
					<img id="userlogo" class="layui-nav-img">
				</a>
				<dl class="layui-nav-child">
					<dd>
						<a href="userinformation">基本资料</a>
					</dd>
					<dd>
						<a href="setPwd">修改密码</a>
					</dd>
				</dl>
			</li>
			<li class="layui-nav-item">
				<a href="javascript:void(0);" onclick="loginout()">退出登录</a>
			</li>
		</ul>

	</div>

    <!-- 主体内容 -->
	<div class="layui-body" style="margin-top:80px;">
		<div style="margin-right:200px;background-color:white;padding:1px 20px 10px 20px;border-radius:25px;">

			<fieldset class="layui-elem-field" style="margin-top: 20px;border-radius:25px;padding:0 20px 0 20px;border-width:2px;">
				<legend style="font-size:22px;font-weight:500;color:#666666;">基本资料</legend>
				<div class="layui-field-box">
					<div class="layui-fluid">
						<div style="background:#eeeeee;padding-top:20px;padding-bottom:20px;margin:20px 50px 10px 50px;border-radius:25px;">
							<div class="layui-row" style="text-align:center;">
								<div class="layui-col-xs6" style="padding-top:20px;">
								    <div class="layui-row grid-demo">
										<div id="name" class="layui-col-md3" style="writing-mode:vertical-lr;padding-top:60px;padding-bottom:20px;font-size:24px;color:grey;letter-spacing:10px;padding-left:60px;">
										</div>
										<div class="layui-col-md9" style="padding-top:35px;">
											<img id="logo" style="width: 150px;border-radius: 50%;"></img>
										</div>
									</div>
								</div>
								<div class="layui-col-xs6">
									<div class="layui-row" style="padding-top:30px;padding-bottom:10px;">
										<div class="layui-col-md1">
											<i class="layui-icon layui-icon-user"></i>
										</div>
										<div id="sduid" class="layui-col-md8" style="font-size:17px;color:grey;margin-top:-1px;">学号</div>
									</div>
									
									<div class="layui-row" style="padding-top:10px;padding-bottom:10px;">
										<div class="layui-col-md1">
											<i class="layui-icon layui-icon-component"></i>
										</div>
										<div id="major" class="layui-col-md8" style="font-size:17px;color:grey;margin-top:-2px;">
											专业
										</div>
									</div>

									<div class="layui-row" style="padding-top:10px;padding-bottom:10px;">
										<div class="layui-col-md1">
											<i class="layui-icon layui-icon-template-1"></i>
										</div>
										<div id="class_num" class="layui-col-md8" style="font-size:17px;color:grey;margin-top:-2px;">
											班级
										</div>
									</div>

									<div class="layui-row" style="padding-top:10px;padding-bottom:10px;">
										<div class="layui-col-md1">
											<i class="layui-icon layui-icon-cellphone-fine"></i>
										</div>
										<div id="phone" class="layui-col-md8" style="font-size:17px;color:grey;">
											手机号
										</div>
									</div>

									<div class="layui-row" style="padding-top:10px;padding-bottom:10px;">
										<div class="layui-col-md1">
											<i class="layui-icon layui-icon-release"></i>
										</div>
										<div id="email" class="layui-col-md8" style="font-size:17px;color:grey;margin-top:-3px;">
											邮箱
										</div>
									</div>
									
									<div class="layui-row" style="padding-top:10px;margin-bottom:30px;">
										<div class="layui-col-md1">
											<i class="layui-icon layui-icon-male"></i>
										</div>
										<div id="sex" class="layui-col-md8" style="font-size:17px;color:grey;margin-top:-3px;">
											性别
										</div>
									</div>
								</div>
							</div>

						</div>
					</div>

					<div style="margin:20px 67px 20px 67px;">
					    <button type="button" id="modify" class="layui-btn  layui-btn-radius layui-btn-danger layui-btn-fluid" style="margin-top:10px;">修 改 信 息</button>
                    </div>
				</div>
			</fieldset>
				
		</div>
	</div>
</div>
</body>
<script>

//获取当前用户
var uid = 0;
$.ajax({
	type: 'GET',
	url: "login/getLogin",
	async: false,
	success: function(data) {
		uid = data;
	}
});

    layui.use(['laypage', 'layer', 'element', 'carousel', 'form', 'upload'], function() {
        var laypage = layui.laypage,
            layer = layui.layer,
            upload = layui.upload,
            element = layui.element,
            carousel = layui.carousel,
            form = layui.form,
            t=layui.view,
            $ = layui.$;
      //显示菜单栏用户信息
		$.ajax({
		    type: 'GET',
		    url: "login/getLoginUser",
		    success: function (data) { 
		    	if(data.type!="学生"){
		    		loginout();
		    	}
		    	$("#username").append(data.name);
		    	$("#userlogo").attr('src',data.user_logo);
		    }
		});
		//是否显示管理菜单
		$.ajax({
			    type: 'GET',
			    url: "login/president",
			    success: function (msg) { 
			        if(msg==0){
			        	$("#nav-manager").hide();
			        }
			        else{
			        	$("#nav-buildclub").hide();
			        }
			    }
			});
		//退出登录
		 loginout=function(){
			$.ajax({
 			    type: 'GET',
 			    url: "login/logout",
 			    success: function (msg) { 
 			        if(msg==1){
 			        	layer.msg('退出成功，正在跳转......', {icon: 6});
	                    setTimeout(function () {
	                        window.location.href = "stu-login";
	                    }, 2000);
 			        }
 			        else{
 			        	layer.msg('退出错误，请重试', {icon: 5});
 			        }
 			    }
 			});
		}
        //监听导航点击
        element.on('nav(demo)', function(elem) {
            //console.log(elem)
            layer.msg(elem.text());
        });

        $.ajax({
            type: 'POST',
            url: "user/selectnow?uid="+uid,
            success: function(data) {
            	$("#logo").attr("src", data.user_logo);
                $("#name").text(data.name);
                $("#sduid").text(data.sduid);
                $("#class_num").text(data.class_num);
                $("#major").text(data.major);
                $("#phone").text(data.phone);
                $("#email").text(data.email);
                $("#sex").text(data.sex);
            },
        });

        $(document).ready(function () {
            $("#modify").click(function () {
                layer.open({
                    title: "修改个人信息",
                    area: ["600px", "600px"],
                    type: 2,
                    content:'user_mod',

                })
            })
        })
    })
</script>